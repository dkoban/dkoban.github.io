---
title: |
  <center>Comparison of Botometer vs. BotometerLite Bot Detection Scores</center>
output:
  html_document:
    toc: true
    toc_float:
      toc_collapsed: true
    theme: lumen
bibliography: citations.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```

<style type="text/css">
.main-container {
  max-width: 1800px;
  margin-left: auto;
  margin-right: auto;
}
</style>

<div style="margin-left: 50px; margin-right:50px;">
**Abstract:** BotometerLite is advertised as a lightweight bot detector that improves scalability by focusing on only user profile information; furthermore, BotometerLite claims that using fewer features only entails a small compromise in individual accuracy. We test the validity of this claim by comparing Botometer with BotometerLite bot likelihood scores for 75,000 users across 5 data sets. We randomly sampled 15,000 users from the following data sets: Coronavirus, 2016 election, News outlets, Charlottesville, and the Twitter API. BotometerLite scores varied drastically from Botometer scores.   
</div> 

## Introduction

Botometer is one of the most popular bot detection tools used in social science @rauchfleisch2020false. However, due to Botometer API rate limits, @beskow2018introducing recommends a tiered framework for bot detection and suggests models that focus only on user profile information can be used at scale for general estimates of bot penetration.

@yuan2019examining used DeBot for large-scale bot annotations when examining tweets related to the 2015 California Disneyland measles outbreak. Whereas, @broniatowski2016effective used Botometer for small-scale bot annotations. 

@dunn2020limited annotated bots based on Botometer scores of 0.5 of greater when assessing the limited role of bots in spreading vaccine-critical information.  Botometer's [FAQ page](https://botometer.osome.iu.edu/faq) explicitly states "It's tempting to set some arbitrary threshold score and consider everything above that number a bot and everything below a human, but we do not recommend this approach. Binary classification of accounts using two classes is problematic because few accounts are completely automated".  Instead, Botometer recommends setting a threshold on the CAP score.  @dunn2020limited acknowledges the number of bots was likely overestimated in this study and unlikely to affect the study results.  

Botometer was initially launched in May 2014 and BotometerLite was released in September 2020. BotometerLite improves scalability by focusing on only user profile information; furthermore, BotometerLite claims that using fewer features only entails a small compromise in individual accuracy @yang2020scalable. The training and performance evaluation of BotometerLite is described in "Scalable and Generalizable Social Bot Detection through Data Selection" @yang2020scalable. 

@rauchfleisch2020false found Botometer scores are imprecise at estimating bots, especially in a different language, and prone to variance over time a high number of human users as bots and vice versa. 

### Contribution

Many researchers annotate bots based on Botometer score thresholds based on precedent established in previous literature (add citations). Understanding how BotometerLite performs in comparison to Botometer is critical to prevent people from thinking BotometerLite can be used as a scalable substitute for Botometer.

### Research Questions

In this study, we seek to answer the following questions: 

- How similar are Botometer and BotometerLite ratings? 
- Is BotometerLite effective at identifying specific types of bots? In other words, are BotometerLite scores strongly correlated with any of the Botometer category scores (e.g., spammers, fake followers, etc.)?
- Can BotometerLite be used as an triage tool to identify a subset of accounts that require more extensive evaluation via Botometer?
- Do some topics have more assessed bots than others?  How do the topic-specific bot category scores compare to a random sample of twitter users?

### Bot Type Scores

The Botometer [FAQ](https://botometer.osome.iu.edu/faq) section assigns bot scores based on the following categories:

- **Astroturf:** manually labeled political bots and accounts involved in follow trains that systematically delete content
- **Fake follower:** bots purchased to increase follower counts
- **Financial:** bots that post using cashtags
- **Self declared:** bots from botwiki.org
- **Spammer:** accounts labeled as spambots from several datasets
- **Other:** miscellaneous other bots obtained from manual annotation, user feedback, etc.

**Complete Automation Probability** describes the probability, according to the Botometer model, that an account with this score or greater is at bot.

## Methodology

1. Randomly sample 20,000 tweet IDs from GWU's [Tweet Sets Library]( https://tweetsets.library.gwu.edu/datasets) in the following collections:
    - [Coronavirus](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/LW0BTB): collected March 3 2020 to June 9, 2020 
    - [2016 election](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/PDI7IN): collected July 13, 2016 to November 10, 2016
    - [News outlets](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/2FIFLH): collected August 4, 2016 to May 12, 2020
    - [Charlottesville](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/DVLJTO): August, 2017
    - Random sample drawn from twitter API
2. Rehydrate the tweet IDs via Twarc to obtain user IDs.
3. Randomly sample 17,000 unique user IDs from the 20,000 tweets (some users are duplicated in the initil 20K sample).
4. Query the Botometer API for 17,000 users (not all users will return a Botometer score)
5. Query the BotometerLite API for 17,000 users (not all users will return a BotometerLite score)  
6. Randomly select 15,000 users who have both Botometer and BotometerLite scores.
7. Compare distribution of CAP scores across data sets.
8. Compare proportion of bot category scores > k across data sets (e.g., how many accounts had astroturf scores greater than k in each data set? did one data set have siginificantly more than others?)
9. Calculate correlation between Botometer and BotometerLite scores.

## Results

The following preliminary results explore the similarity between Botometer and BotometerLite scores for 10,000 users sampled from a 5G conspiracy theory tweet set.  

I am currently collecting botscores from the GWU Tweet Sets library to be used in the final paper.    

### Raw English Scores

BotometerLite is most similar to the Botometer fake follower and spammer scores with $R^2$ values of 0.394 and 0.334, respectively.  Hence, if Botometer scores are accurate, BotometerLite may be somewhat effective at identifying some fake followers and spammers.

```{r, fig.width=14, fig.height=12}
library(tidyverse)
library(readxl)
library(ggplot2)

bot_full <- read_excel("botometer_full.xlsx")
bot_lite <- read_csv("botometer_scores_20Oct2020.csv") %>%
  select(id_str = user_id, bot_lite = botscore) %>% 
  mutate(id_str = id_str %>% as.character())

df <- left_join(bot_full, bot_lite, by = "id_str") %>%
  filter(!is.na(bot_lite), !is.na(overall_raw_en)) 
  
df <- bind_rows(
  df %>% select(id_str, screen_name, 
                bot_full = astroturf_raw_en, bot_lite) %>%
    mutate(type = "Astroturf"),
  df %>% select(id_str, screen_name, 
                bot_full = fake_follower_raw_en, bot_lite) %>%
    mutate(type = "Fake Follower"),
  df %>% select(id_str, screen_name, 
                bot_full = financial_raw_en, bot_lite) %>%
    mutate(type = "Financial"),
  df %>% select(id_str, screen_name, 
                bot_full = spammer_raw_en, bot_lite) %>%
    mutate(type = "Spammer"),
  df %>% select(id_str, screen_name, 
                bot_full = self_declared_raw_en, bot_lite) %>%
    mutate(type = "Self Declared"),
  df %>% select(id_str, screen_name,
                bot_full = other_raw_en, bot_lite) %>%
    mutate(type = "Other"),
  df %>% select(id_str, screen_name,
                bot_full = overall_raw_en, bot_lite) %>%
    mutate(type = "Overall"),
  df %>% select(id_str, screen_name,
                bot_full = cap_en, bot_lite) %>%
    mutate(type = "Complete Automation Probability"))       

lm_eqn = function(df){
    m = lm(bot_full ~ bot_lite, df);
    eq <- substitute(italic(r)^2~"="~r2, 
         list(r2 = format(summary(m)$r.squared, digits = 3)))
    as.character(as.expression(eq));                 
}        

require(plyr)
eq <- ddply(df,.(type),lm_eqn)

ggplot(data = df,
       mapping = aes(x = bot_lite,
                     y = bot_full)) +
  geom_point(size = 0.5, color = "blue", alpha = 0.5) +
   stat_smooth(method = "lm",color="red") +
  geom_label(data=eq,aes(x = 0.85, y = 0.9,label=V1), 
            parse = TRUE, inherit.aes=FALSE) +
  facet_wrap(~type, ncol = 3) +
  labs(title = "Botometer vs. BotometerLite Bot Likelihood Scores",
         x = "BotometerLite Score",
         y = "Botometer Score")
```

The pearson correlation matrix ($R^2$ values are the square of the values of this matrix) also shows the scores are weakly correlated.

<center>
#![](correlation_heat_map.png){width=600px}
</center>

### CAP Distribution 

27% of the sample users have a Complete Automation Probability (CAP) of 0.75 or greater.  Hence, if we apply a threshold of 0.75 to annotate bots in the data, roughly 1 out of 4 users in our sample would labeled as a bot.  

Likewise, 53% of the sample users have a CAP of 0.5 or greater meaning over half of the bots would be labeled as bots.  This seems highly unlikely.

```{r}
#sum(bot_full$cap_en >= 0.75)/length(bot_full$cap_en)
bot_full$cap_en %>% hist(main = "Distribution of Complete Automation Probability Scores", 
                         xlab = "Complete Automation Probability")
#sum(bot_full$cap_en >= 0.5)/length(bot_full$cap_en)
```

## Conclusion

Future work for course project:

- Update introduction to include other articles that have critiqued Botometer
- For EM6574 only, replicate results of Indiana University BotometerLite paper (Train a classifier to predict manually labeled bots and compare with BotometerLite)
- Post code to github repo

Questions:

- Should I expand this beyond Botometer and include a comparison of scores generated from other models (e.g., DeBot, BotSlayer, etc.)
- Has anyone used DeBot? I requested an API key but did not receive a response.
- Do I have "the right" number for each of my samples (15,000 users per data set)?  Is a random sample appropriate?
- What statistical tests should we do to provide evidence Botometer and BotometerLite produce different results?  t-test for difference of means? F-test for difference of variance? Hotelling test across all bot scores?
- Should we look at just the scores derived from english-speaking accounts or also include the universal scores?
- What visualizations should we use?  tSNE separating accounts with CAP > 0.8 from those with CAP < 0.8? 

## References

---
nocite: '@*'
---
